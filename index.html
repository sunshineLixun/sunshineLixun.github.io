<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="做一个有文艺气息的程序猿">
<meta property="og:type" content="website">
<meta property="og:title" content="Sunshine">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Sunshine">
<meta property="og:description" content="做一个有文艺气息的程序猿">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Sunshine">
<meta name="twitter:description" content="做一个有文艺气息的程序猿">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/"/>

  <title> Sunshine </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Sunshine</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">lx的个人博客</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/10/iOS开发小技巧(一)/" itemprop="url">
                  iOS开发小技巧(一)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-10T20:44:20+08:00" content="2016-10-10">
              2016-10-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective - C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="改变UIImagePickerController的导航条以及title的颜色"><a href="#改变UIImagePickerController的导航条以及title的颜色" class="headerlink" title="改变UIImagePickerController的导航条以及title的颜色"></a>改变UIImagePickerController的导航条以及title的颜色</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated</div><div class="line">&#123;</div><div class="line">   [UIApplication sharedApplication].statusBarStyle = UIStatusBarStyleLightContent;</div><div class="line">    UINavigationBar *bar = [UINavigationBar appearance];</div><div class="line">    NSMutableDictionary *titleDictionary = [NSMutableDictionary dictionary];</div><div class="line">    titleDictionary[NSForegroundColorAttributeName] = [UIColor whiteColor];</div><div class="line">    [bar setTitleTextAttributes:titleDictionary];</div><div class="line">    viewController.navigationController.navigationBar.barTintColor = DIF_BASE_COLOR;</div><div class="line">    viewController.navigationController.navigationBar.tintColor = [UIColor whiteColor];</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="利用KVC改变TextField的占位符的颜色"><a href="#利用KVC改变TextField的占位符的颜色" class="headerlink" title="利用KVC改变TextField的占位符的颜色"></a>利用KVC改变TextField的占位符的颜色</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[self.nickNameTextField setValue:[UIColor whiteColor] forKeyPath:@&quot;_placeholderLabel.textColor&quot;];</div></pre></td></tr></table></figure>
<h1 id="TextView的字数限制"><a href="#TextView的字数限制" class="headerlink" title="TextView的字数限制"></a>TextView的字数限制</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">#define MaxNumberOfDescriptionChars  150</div><div class="line"></div><div class="line">-(void)textViewEditChanged:(NSNotification *)obj&#123;</div><div class="line">    UITextView *textView = (UITextView *)obj.object;</div><div class="line">    NSString *toBeString = textView.text;</div><div class="line">    NSString *lang = [[UITextInputMode currentInputMode] primaryLanguage]; // 键盘输入模式</div><div class="line">    if ([lang isEqualToString:@&quot;zh-Hans&quot;]) &#123; // 简体中文输入，包括简体拼音，健体五笔，简体手写</div><div class="line">        UITextRange *selectedRange = [textView markedTextRange];</div><div class="line">        //获取高亮部分</div><div class="line">        UITextPosition *position = [textView positionFromPosition:selectedRange.start offset:0];</div><div class="line">        // 没有高亮选择的字，则对已输入的文字进行字数统计和限制</div><div class="line">        if (!position) &#123;</div><div class="line">            if (toBeString.length &gt; MaxNumberOfDescriptionChars) &#123;</div><div class="line">                textView.text = [toBeString substringToIndex:MaxNumberOfDescriptionChars];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        // 有高亮选择的字符串，则暂不对文字进行统计和限制</div><div class="line">        else&#123;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    // 中文输入法以外的直接对其统计限制即可，不考虑其他语种情况</div><div class="line">    else&#123;</div><div class="line">        if (toBeString.length &gt; MaxNumberOfDescriptionChars) &#123;</div><div class="line">            </div><div class="line">            textView.text = [toBeString substringToIndex:MaxNumberOfDescriptionChars];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text&#123;</div><div class="line">    NSString *new = [textView.text stringByReplacingCharactersInRange:range withString:text];</div><div class="line">    self.numLabel.text = [NSString stringWithFormat:@&quot;%zd字&quot;,(MaxNumberOfDescriptionChars - new.length)];</div><div class="line">    if(new.length &gt; MaxNumberOfDescriptionChars)&#123;</div><div class="line">         self.numLabel.text = [NSString stringWithFormat:@&quot;%zd字&quot;,0];</div><div class="line">        if (![text isEqualToString:@&quot;&quot;]) &#123;</div><div class="line">            return NO;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return YES;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/09/load VS initialize/" itemprop="url">
                  load VS initialize
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-09T20:35:30+08:00" content="2016-10-09">
              2016-10-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective - C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="共同点"><a href="#共同点" class="headerlink" title="共同点"></a>共同点</h1><p>方法只会被调用一次(相对于runtime而言)</p>
<h1 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h1><h2 id="load方法"><a href="#load方法" class="headerlink" title="load方法"></a>load方法</h2><p>声明一个SuperClass类继承与NSObject </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@implementation SuperClass</div><div class="line">+ (void) load &#123;</div><div class="line">  NSLog(@&quot;加载load方法&quot;); </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在main.m文件中导入头文件 <code>#import &quot;SuperClass.h&quot;</code></p>
<p>控制台打印输出 <code>Test[1558:44427] 加载load方法</code></p>
<p>得出结论:load是只要类所在文件被引用就会被调用</p>
<h2 id="initialize方法"><a href="#initialize方法" class="headerlink" title="initialize方法"></a>initialize方法</h2><p>执行以下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">+ (void) initialize &#123;</div><div class="line">    NSLog(@&quot;%@ %s&quot;, [self class], __FUNCTION__);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (void) load &#123;</div><div class="line">    NSLog(@&quot;%@ %s&quot;, [self class], __FUNCTION__);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>控制台打印输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">SuperClass +[SuperClass initialize]</div><div class="line">SuperClass +[SuperClass load]</div></pre></td></tr></table></figure>
<p>为什么initialize方法会再load方法前调用呢？通过Apple的文档</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">The runtime sends initialize to each class in a program exactly one time just before the class, or any class that inherits from it, is sent its first message from within the program. (Thus the method may never be invoked if the class is not used.) The runtime sends the initialize message to classes in a thread-safe manner. Superclasses receive this message before their subclasses.</div></pre></td></tr></table></figure>
<p>得知: initialize方法在类的第一个方法被调用前调用。即先执行load方法中的[self class] 就会调用initialize方法。</p>
<h2 id="子类会调用父类的initialize"><a href="#子类会调用父类的initialize" class="headerlink" title="子类会调用父类的initialize"></a>子类会调用父类的initialize</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">@interface ChildClass : SuperClass</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line"></div><div class="line">@implementation SuperClass</div><div class="line"></div><div class="line">+ (void) initialize &#123;</div><div class="line">    NSLog(@&quot;%@ %s&quot;, [self class], __FUNCTION__);</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line"></div><div class="line">@implementation ChildClass</div><div class="line"></div><div class="line">+ (void)load</div><div class="line">&#123;</div><div class="line">    NSLog(@&quot;%@ %s&quot;, [self class], __FUNCTION__);</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>还是导入头文件而不去使用它控制台打印输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SuperClass +[SuperClass initialize]</div><div class="line">ChildClass +[ChildClass initialize]</div><div class="line">ChildClass +[ChildClass load]</div></pre></td></tr></table></figure>
<h2 id="类别-Category-中的-void-load的-void-initialize"><a href="#类别-Category-中的-void-load的-void-initialize" class="headerlink" title="类别(Category)中的+(void)load的+(void)initialize"></a>类别(Category)中的+(void)load的+(void)initialize</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">/******* Interface *******/</div><div class="line">@interface MainClass : NSObject</div><div class="line">@end</div><div class="line"></div><div class="line">/******* Category Implementation *******/</div><div class="line">@implementation MainClass(Category)</div><div class="line"></div><div class="line">+ (void) load &#123;</div><div class="line">    NSLog(@&quot;%@ %s&quot;, [self class], __FUNCTION__);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (void) initialize &#123;</div><div class="line">    NSLog(@&quot;%@ %s&quot;, [self class], __FUNCTION__);</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation MainClass(OtherCategory)</div><div class="line"></div><div class="line">+ (void) load &#123;</div><div class="line">    NSLog(@&quot;%@ %s&quot;, [self class], __FUNCTION__);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (void) initialize &#123;</div><div class="line">    NSLog(@&quot;%@ %s&quot;, [self class], __FUNCTION__);</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">/******* Implementation *******/</div><div class="line">@implementation MainClass</div><div class="line"></div><div class="line">+ (void) load &#123;</div><div class="line">    NSLog(@&quot;%@ %s&quot;, [self class], __FUNCTION__);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (void) initialize &#123;</div><div class="line">    NSLog(@&quot;%@ %s&quot;, [self class], __FUNCTION__);</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>import 之后 </p>
<p>MainClass +[MainClass(OtherCategory) initialize]<br>MainClass +[MainClass load]<br>MainClass +[MainClass(Category) load]<br>MainClass +[MainClass(OtherCategory) load]</p>
<p>先执行类自身的实现，再执行类别(Category)中的实现</p>
<h2 id="不需要调用-super-load-和-super-initialize"><a href="#不需要调用-super-load-和-super-initialize" class="headerlink" title="不需要调用[super load] 和 [super initialize]"></a>不需要调用[super load] 和 [super initialize]</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">+ (void)initialize &#123;</div><div class="line">    //do initialization thing</div><div class="line">    [super initialize];</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (void) load &#123;</div><div class="line">    //do some loading things</div><div class="line">    [super load];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样写是多余的</p>
<h1 id="开发过程中需要注意"><a href="#开发过程中需要注意" class="headerlink" title="开发过程中需要注意"></a>开发过程中需要注意</h1><p>在使用Method Swizzling或者需要对类进行一些初始化的时候,一般都在initialize的方法中,确保会调用这个类的方法时才会执行所需代码,而写在load方法中,即使这个类没有被使用也会执行相关代码,在使用Method Swizzling时在全局影响到这个类。写在initialize可以规避一些不必要的bug。</p>
<p>参考链接:<br><a href="http://www.cnblogs.com/ider/archive/2012/09/29/objective_c_load_vs_initialize.html" target="_blank" rel="external">Objective C类方法load和initialize的区别</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/24/3D - Touch之Peek & Pop/" itemprop="url">
                  3D - Touch（二）之Peek & Pop
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-24T10:21:50+08:00" content="2016-09-24">
              2016-09-24
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Swift/" itemprop="url" rel="index">
                    <span itemprop="name">Swift</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在介绍了前面的桌面的3D-Touch,这篇文章来介绍应用中使用peek &amp; pop。 比如QQ 微信中消息界面重压cell就会出现peek &amp; pop。接下来实现这一效果。</p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><h2 id="创建视图-sourceView"><a href="#创建视图-sourceView" class="headerlink" title="创建视图(sourceView)"></a>创建视图(sourceView)</h2><p>首先用tableview来做例子。用storyboard创建表,在这里就不赘述了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var titleArray = [&quot;3D-Touch Objective-C&quot;,&quot;3D-Touch Swift&quot;,&quot;前言快报:Swift终将超越OC,进而取代OC&quot;,&quot;Github9月编程语言 JS 跃居第一位&quot;]</div></pre></td></tr></table></figure>
<p>创建一个数组来做tableview的数据源。</p>
<h2 id="实现代理"><a href="#实现代理" class="headerlink" title="实现代理"></a>实现代理</h2><p>在实现这一效果之前,需要使当前的控制器实现<code>UIViewControllerPreviewingDelegate</code>代理并且要判断当前设备是否支持Peek &amp; pop:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">if traitCollection.forceTouchCapability == .available&#123;</div><div class="line">            registerForPreviewing(with: self, sourceView: tableView)</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<p>代理中有两个方法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public func previewingContext(_ previewingContext: UIViewControllerPreviewing, viewControllerForLocation location: CGPoint) -&gt; UIViewController?</div></pre></td></tr></table></figure>
<p>第一个参数可以获取到要显示的是哪个目标view（sourceView）以及手势,其中有个属性（sourceRect）还可以控制那块区域展示出peek的效果</p>
<p>第二个参数location 顾名思义就是要控制能产生重压的区域。(与第一个参数的sourceRect不同,sourceRect只是哪片区域要展示peek效果,就是在屏幕中视图凸起的那一部分。如果不设置默认就是整个sourceView,而这个参数则是控制哪些区域能使用peek效果)。注意 “能” 和 “要”。<br>这个方法返回的是要显示的那个控制器,就是pop预览的那个控制器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public func previewingContext(_ previewingContext: UIViewControllerPreviewing, commit viewControllerToCommit: UIViewController)</div></pre></td></tr></table></figure>
<p>这个方法就是用来做跳转的。</p>
<h2 id="开始实现代理方法"><a href="#开始实现代理方法" class="headerlink" title="开始实现代理方法"></a>开始实现代理方法</h2><p>我们需要新建一个控制器来做pop效果,返回出这个控制器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">func previewingContext(_ previewingContext: UIViewControllerPreviewing, viewControllerForLocation location: CGPoint) -&gt; UIViewController? &#123;</div><div class="line">    guard let indexPath = tableView.indexPathForRow(at:location) , let cell = tableView.cellForRow(at: indexPath) else &#123;</div><div class="line">        return nil</div><div class="line">    &#125;</div><div class="line">    let detailVC  = UIStoryboard.init(name: &quot;Main&quot;, bundle: nil).instantiateViewController(withIdentifier: &quot;detail&quot;) as! DetailViewController</div><div class="line">    previewingContext.sourceRect = cell.frame</div><div class="line">    detailVC.text = (cell.textLabel?.text)!</div><div class="line">    return detailVC</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">    func previewingContext(_ previewingContext: UIViewControllerPreviewing, commit viewControllerToCommit: UIViewController) &#123;</div><div class="line">//        self.show(viewControllerToCommit, sender: self)</div><div class="line">        self.navigationController?.pushViewController(viewControllerToCommit, animated: true)</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>show 和 push都能展示出相同的效果</p>
<h2 id="在显示的控制器中设置代码"><a href="#在显示的控制器中设置代码" class="headerlink" title="在显示的控制器中设置代码"></a>在显示的控制器中设置代码</h2><p>在detailviewcontroller中需要返回出pop向上拉的选项。（也可以不实现）另外要为了要展示出数据,我在该视图控制器中添加了一个textview来展示数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">self.title = &quot;详情&quot;</div><div class="line">self.automaticallyAdjustsScrollViewInsets = false</div><div class="line">self.textView.text = text</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">override var previewActionItems: [UIPreviewActionItem]&#123;</div><div class="line">       </div><div class="line">       let action1 = UIPreviewAction.init(title: &quot;喜欢&quot;, style: .default) &#123; (UIPreviewAction, UIViewController) in </div><div class="line">       &#125;</div><div class="line">       </div><div class="line">       let action2 = UIPreviewAction.init(title: &quot;收藏&quot;, style: .default) &#123; (UIPreviewAction, UIViewController) in</div><div class="line">           </div><div class="line">       &#125;</div><div class="line">       </div><div class="line">       let cancle = UIPreviewAction.init(title: &quot;取消&quot;, style: .default) &#123; (UIPreviewAction, UIViewController) in</div><div class="line">           </div><div class="line">       &#125;</div><div class="line">       </div><div class="line">       let delete = UIPreviewAction.init(title: &quot;删除&quot;, style: .destructive) &#123; (UIPreviewAction, UIViewController) in</div><div class="line">           </div><div class="line">       &#125;</div><div class="line">   </div><div class="line">       let actionGroup = UIPreviewActionGroup.init(title: &quot;删除&quot;, style: .destructive, actions: [cancle,delete])</div><div class="line">       </div><div class="line">       return [action1, action2 ,actionGroup]</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>返回的数组中存的是UIPreviewAction。这个数组可以是个二维数组,所以可以展示出很多选项。例子中返回的就是一个二维数组。</p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>到此整个效果的代码都设置完了。接下来运行程序,看看我们的成果吧:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1421047-f73b14b53899dc5b.gif?imageMogr2/auto-orient/strip" alt="3D- Touch.gif"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/23/3D-Touch 桌面/" itemprop="url">
                  3D - Touch(一) 桌面
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-23T20:07:51+08:00" content="2016-09-23">
              2016-09-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Swift/" itemprop="url" rel="index">
                    <span itemprop="name">Swift</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="桌面3D-Touch"><a href="#桌面3D-Touch" class="headerlink" title="桌面3D - Touch"></a>桌面3D - Touch</h1><h2 id="快捷静态操作（Quick-actions）"><a href="#快捷静态操作（Quick-actions）" class="headerlink" title="快捷静态操作（Quick actions）"></a>快捷静态操作（Quick actions）</h2><p>需要在 <code>info.plist</code>中配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&lt;key&gt;UIApplicationShortcutItems&lt;/key&gt;</div><div class="line">&lt;array&gt;</div><div class="line">	&lt;dict&gt;</div><div class="line">		&lt;key&gt;UIApplicationShortcutItemIconType&lt;/key&gt;</div><div class="line">		&lt;string&gt;UIApplicationShortcutIconTypeShare&lt;/string&gt;</div><div class="line">		&lt;key&gt;UIApplicationShortcutItemTitle&lt;/key&gt;</div><div class="line">		&lt;string&gt;弹一弹&lt;/string&gt;</div><div class="line">		&lt;key&gt;UIApplicationShortcutItemType&lt;/key&gt;</div><div class="line">		&lt;string&gt;com.yuwubao.search&lt;/string&gt;</div><div class="line">	&lt;/dict&gt;</div><div class="line">	&lt;dict&gt;</div><div class="line">		&lt;key&gt;UIApplicationShortcutItemIconType&lt;/key&gt;</div><div class="line">		&lt;string&gt;UIApplicationShortcutIconTypeShare&lt;/string&gt;</div><div class="line">		&lt;key&gt;UIApplicationShortcutItemTitle&lt;/key&gt;</div><div class="line">		&lt;string&gt;摇一摇&lt;/string&gt;</div><div class="line">		&lt;key&gt;UIApplicationShortcutItemType&lt;/key&gt;</div><div class="line">		&lt;string&gt;com.yuwubao.search&lt;/string&gt;</div><div class="line">	&lt;/dict&gt;</div><div class="line">	&lt;dict&gt;</div><div class="line">		&lt;key&gt;UIApplicationShortcutItemIconType&lt;/key&gt;</div><div class="line">		&lt;string&gt;UIApplicationShortcutIconTypeShare&lt;/string&gt;</div><div class="line">		&lt;key&gt;UIApplicationShortcutItemTitle&lt;/key&gt;</div><div class="line">		&lt;string&gt;扫一扫&lt;/string&gt;</div><div class="line">		&lt;key&gt;UIApplicationShortcutItemType&lt;/key&gt;</div><div class="line">		&lt;string&gt;com.yuwubao.search&lt;/string&gt;</div><div class="line">	&lt;/dict&gt;</div><div class="line">&lt;/array&gt;</div></pre></td></tr></table></figure>
<p>关于几个必须要填写的项：</p>
<ol>
<li>UIApplicationShortcutItemTitle:  表示要显示的标题。展示在你的quick action菜单中的action标题。如果标题一行无法显示并且你没有指定子标题那么它将显示两行。可以使用本地化(localised)。</li>
<li>UIApplicationShortcutItemType:  作为UIApplicationShortcutItem的一部分发送给你的应用。可以依据不同的shortcut类型用于执行你的actions。命名规则为： com.公司名.app名.图标作用名</li>
</ol>
<p>关于选填的项：</p>
<ol>
<li>UIApplicationShortcutItemIconType:  定义内置图标类型的字符串，可选类型列表可以查询<a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIApplicationShortcutIcon_Class/index.html#//apple_ref/c/tdef/UIApplicationShortcutIconType" target="_blank" rel="external">这里</a></li>
<li>UIApplicationShortcutItemSubtitle:  用户展示你的actions的子标题的字符串。它将显示在你的quick actions标题的下方。可以本地化。</li>
<li>UIApplicationShortcutItemIconFile：一个指定Assets Catalog或者Bundle中的字符串。如果指定了此键，则系统会忽略UIApplicationShortcutItemIconType</li>
<li>UIApplicationShortcutItemUserInfo：一个字典，包含你想要解析的其他信息。</li>
</ol>
<h2 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h2><p>在入口类文件（appDelegate）中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -&gt; Bool &#123;</div><div class="line">        </div><div class="line">        //检测版本</div><div class="line">        if UIDevice.current.systemVersion &gt;= &quot;9.0&quot; &#123;</div><div class="line">            let shortcutItem = launchOptions?[UIApplicationLaunchOptionsKey.shortcutItem] as? UIApplicationShortcutItem</div><div class="line">            if let shortcutItem = shortcutItem&#123;</div><div class="line">                self.quickActionWithShortcutItem(shortcutItem: shortcutItem)</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">        &#125;</div><div class="line"></div><div class="line">        return true</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>还要实现另一个方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//MARK: - 3D-Touch</div><div class="line"> func application(_ application: UIApplication, performActionFor shortcutItem: UIApplicationShortcutItem, completionHandler: @escaping (Bool) -&gt; Void) &#123;</div><div class="line">     self.quickActionWithShortcutItem(shortcutItem: shortcutItem)</div><div class="line">     completionHandler(true)</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>由于代码的冗余 需要定义一个私有的方法 可以根据<br><code>localizedTitle</code> 或者 <code>type</code> 来区别点击的是哪个。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">private  func quickActionWithShortcutItem(shortcutItem: UIApplicationShortcutItem)&#123;</div><div class="line">      let nav = self.window?.rootViewController as? UINavigationController</div><div class="line">      if shortcutItem.localizedTitle == &quot;弹一弹&quot;&#123;</div><div class="line">          </div><div class="line">      &#125;else if shortcutItem.localizedTitle == &quot;摇一摇&quot;&#123;</div><div class="line">          </div><div class="line">          let detailVC = UIStoryboard.init(name: &quot;Main&quot;, bundle: nil).instantiateViewController(withIdentifier: &quot;detail&quot;) as! DetailViewController</div><div class="line">          nav!.pushViewController(detailVC, animated: true)</div><div class="line">          </div><div class="line">      &#125;else&#123;</div><div class="line">          </div><div class="line">          nav!.pushViewController(ThirdViewController(), animated: true)</div><div class="line">      &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>到这里完全设置好了桌面图标的3D - Touch。 由于最近系统升级到了iOS10 桌面icon的3D - Touch 新增了widget。接下来就来时适配iOS10。</p>
<h1 id="Extention"><a href="#Extention" class="headerlink" title="Extention"></a>Extention</h1><p>(更多信息移步到<a href="https://onevcat.com/2014/08/notification-today-widget/" target="_blank" rel="external">这里</a>)(喵神博客)</p>
<p>Extensions不是独立的应用程序。Extensions必须依赖于一个host app，叫作宿主APP，同时他们的生命周期相互独立，并且可以互相触发事件。一个宿主APP可以包含多个Extensions。本篇文章主要是 Today Extention。创建方法 <code>File-&gt;New-&gt;Target</code></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1421047-2c7a1a352ceedf42.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20160923-0@2x.png"></p>
<p>工程中会多出这些文件</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1421047-8d30c066607b9592.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20160923-1@2x.png"></p>
<p>在MainInterface.storyboard中我们可以定制UI。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1421047-4ac148040ca13437.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20160923-3@2x.png"></p>
<p>当我们想纯代码构建UI时,在上图显示的Info.plist中NSExtension需要将NSExtensionMainStoryboard删掉,解除与storyboard的关联</p>
<p>例子中用的storyboard构建UI。 当我们需要与APP通信时。需要用到 URL Shchemes。</p>
<h2 id="首先给label添加手势"><a href="#首先给label添加手势" class="headerlink" title="首先给label添加手势"></a>首先给label添加手势</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">widgetLabel.addGestureRecognizer(UITapGestureRecognizer.init(target: self</div><div class="line">            , action: #selector(TodayViewController.widgetLabelAction)))</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@objc private  func widgetLabelAction() -&gt; Void &#123;</div><div class="line">       extensionContext?.open(NSURL(string: &quot;simple://finished&quot;) as! URL, completionHandler: nil)</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h2 id="设置URL-Schemes"><a href="#设置URL-Schemes" class="headerlink" title="设置URL Schemes"></a>设置URL Schemes</h2><p><img src="http://upload-images.jianshu.io/upload_images/1421047-a28aeabf864d2fc2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ20160923-4@2x.png"></p>
<p>运行程序</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1421047-108a96a4f30cd1bf.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="IMG_0609.PNG"></p>
<p>我们也可以在widget中添加自己的APP显示信息了</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/20/Swift基础/" itemprop="url">
                  Swift基础
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-20T22:54:59+08:00" content="2016-09-20">
              2016-09-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Swift/" itemprop="url" rel="index">
                    <span itemprop="name">Swift</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="stride与循环结构"><a href="#stride与循环结构" class="headerlink" title="stride与循环结构"></a>stride与循环结构</h1><p>区间运算符<br>开区间：[a,b]<br>闭区间：[a,b)<br>举例：<br>1.开区间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">for index in 1..&lt;10&#123;</div><div class="line">    index;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>index的值一次为:0~9;可以用此方法遍历数组。比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var scoreArr = [22,33,44,55,66,77,88,99];</div><div class="line">var count = scoreArr.count;</div><div class="line">for index in 0 ..&lt; count&#123;</div><div class="line">    var s = scoreArr[index];</div><div class="line">    print(s);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2.闭区间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">for index in 1...10&#123;</div><div class="line">    index;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>index的值以此为：0~10</p>
<h1 id="在swift3-0中stride语法已经改为这样-stride-from-to-by-函数和stride-from-through-by-函数"><a href="#在swift3-0中stride语法已经改为这样-stride-from-to-by-函数和stride-from-through-by-函数" class="headerlink" title="在swift3.0中stride语法已经改为这样:stride(from: , to: , by: )函数和stride(from: , through: , by: )函数"></a>在swift3.0中stride语法已经改为这样:stride(from: , to: , by: )函数和stride(from: , through: , by: )函数</h1><p>stride 方法定义在 Strideable 协议中,swift3.0废弃了传统C的for循环之后，定义的全新方法。<br>stride(from: , to: , by: )相当于开区间；<br>stride(from: , through: , by: )相当于闭区间<br>个人理解：<br>表示从初始数值到目标数值,by:表示跨越的进度（可加可减）。<br>举例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">for index in stride(from: 10, through: 0, by: -1)&#123;</div><div class="line">    print(index);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/1421047-c9a76252e83621c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="屏幕快照 2016-09-07 下午10.03.33.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">for index in stride(from: 10, to: 0, by: -1)&#123;</div><div class="line">    print(index);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>index的数值:<br>index –10<br>index –9<br>index –8<br>index –7<br>index –6<br>index –5<br>index –4<br>index –3<br>index –2<br>index –1</p>
<h2 id="用stride方法遍历scoreArr数组"><a href="#用stride方法遍历scoreArr数组" class="headerlink" title="用stride方法遍历scoreArr数组"></a>用stride方法遍历scoreArr数组</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">for i in stride(from: 0, to: scoreArr.count, by: 1)&#123;</div><div class="line">    var arr = scoreArr[i];</div><div class="line">    print(arr);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/20/多种方法使tableView的Header下拉放大/" itemprop="url">
                  多种方法使tableView的Header下拉放大
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-20T22:15:16+08:00" content="2016-09-20">
              2016-09-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective-C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>看了<a href="http://www.jianshu.com/users/b09c3959ab3b/latest_articles" target="_blank" rel="external">峥吖</a>同学的这篇文章<a href="http://www.jianshu.com/p/859e3ef76b05" target="_blank" rel="external">【一行代码快速集成tableView头部缩放视图】</a>之后 。想着自己用其他的方法来实现这一效果，于是乎想到</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CGAffineTransformMakeScale</div></pre></td></tr></table></figure>
<p>这一方法。</p>
<h1 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h1><p><img src="http://upload-images.jianshu.io/upload_images/1421047-f9cf98990ebda6b2.gif?imageMogr2/auto-orient/strip" alt="下拉放大.gif"></p>
<h1 id="开始实现"><a href="#开始实现" class="headerlink" title="开始实现"></a>开始实现</h1><p>在自己写的过程中发现了一些问题, 直接把</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">self.tableView.tableHeaderView = self.imageView</div></pre></td></tr></table></figure>
<p>之后并不能达到想要的效果。整张图片frame都随着tableview的拖动而改变。并不是像是固定在那里。tableview的顶部会出现大部分空白。然后我仔细看了一遍源码。发现做法是</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[self.tableView insertSubview:imageView atIndex:0];</div></pre></td></tr></table></figure>
<p>接着把一个透明view填充到tableview的header view中。   </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">UIView *headerView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 0, 200)];    </div><div class="line">headerView.backgroundColor = [UIColor clearColor];    </div><div class="line">self.tableView.tableHeaderView = headerView;</div></pre></td></tr></table></figure>
<p>找到这一技巧之后。自己写了一个稍微简单的demo。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">UIImageView *imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@<span class="string">"header"</span>]];</div><div class="line">imageView.frame = CGRectMake(0, 0, self.view.frame.size.width, imageViewH);</div><div class="line">[self.tableView insertSubview:imageView atIndex:0];</div><div class="line">self.imageView = imageView;</div><div class="line"></div><div class="line">UIView *headerView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 0, imageViewH)];</div><div class="line">headerView.backgroundColor = [UIColor clearColor];</div><div class="line">self.tableView.tableHeaderView = headerView;</div></pre></td></tr></table></figure>
<p>在</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (void)scrollViewDidScroll:(UIScrollView *)scrollView</div></pre></td></tr></table></figure>
<p>方法中这么写:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">CGFloat offsetY = scrollView.contentOffset.y;</div><div class="line">  <span class="keyword">if</span> (offsetY &lt; 0) &#123;</div><div class="line">      self.imageView.frame = CGRectMake(offsetY, offsetY, scrollView.bounds.size.width - offsetY * 2, imageViewH - offsetY);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">      self.imageView.frame = CGRectMake(0, 0, scrollView.bounds.size.width, imageViewH);</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>原理一模一样,拿到scrollview的偏移量计算下拉imageview的frame,使其imageview的宽高增大。上拉的时候恢复原来的frame。</p>
<h1 id="另一种方法"><a href="#另一种方法" class="headerlink" title="另一种方法"></a>另一种方法</h1><p>还是在</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (void)scrollViewDidScroll:(UIScrollView *)scrollView</div></pre></td></tr></table></figure>
<p>方法中拿到scrollview的偏移量计算缩放系数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">CGFloat offsetY = scrollView.contentOffset.y + scrollView.contentInset.top;</div><div class="line">CGFloat scale = 1.0;</div><div class="line"><span class="keyword">if</span> (offsetY &lt; 0) &#123;</div><div class="line">    //向下拉</div><div class="line">    scale = MIN(2.5, 1 - offsetY / imageViewH);</div><div class="line">    self.imageView.transform = CGAffineTransformMakeScale(scale, scale);</div><div class="line">    CGRect frame = self.imageView.frame;</div><div class="line">    frame.origin.y = offsetY;</div><div class="line">    self.imageView.frame = frame;</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(offsetY &gt; 0)</div><div class="line">&#123;</div><div class="line">    //向上拉</div><div class="line">    CGRect frame = self.imageView.frame;</div><div class="line">    frame.origin.y = -offsetY/imageViewH;</div><div class="line">    self.imageView.frame = frame;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>再向上拉的过程中要保证imageview不会进行缩放，只是改变下imageview的y轴的值。</p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>感谢<a href="http://www.jianshu.com/users/b09c3959ab3b/latest_articles" target="_blank" rel="external">峥吖</a>同学提供的思路。demo地址:<a href="https://github.com/sunshineLixun/tableViewHeaderScale" target="_blank" rel="external">戳我</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="Sunshine" />
          <p class="site-author-name" itemprop="name">Sunshine</p>
          <p class="site-description motion-element" itemprop="description">做一个有文艺气息的程序猿</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">6</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/sunshineLixun" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sunshine</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>
